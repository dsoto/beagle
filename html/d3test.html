<html>
<head>
    <link type="text/css" rel="stylesheet" href="line.css"/>
    <script type="text/javascript" src="d3/d3.js"></script>
    <script src=http://code.jquery.com/jquery.js></script>
</head>
<body>
    <script type="text/javascript">
        jQuery.getJSON(
            "http://app.nimbits.com/service/point?uuid=12a17a96-bc04-4e45-b129-ad33cae517e1&count=500",
            {format:"json"},
            // json object/string gets placed in data
            // values field of object is an array of strings with individual values
            // we lump these into an object named d3values
            function(data) {
                var d3values = new Array();
                for (i in data.values) {
                    d3values[i] = jQuery.parseJSON(data.values[i]);
                 }

                 var w = 500,
                     h = 500,
                     p = 20,
                     x = d3.scale.linear().domain([1324900000000,1325000000000]).range([0,w]),
                     y = d3.scale.linear().domain([20,30]).range([h,0]);

                 var vis = d3.select("body")
                            .data([d3values])
                            .append("svg:svg")
                            .attr("width", w+p*2)
                            .attr("height", h+p*2)
                            .append("svg:g");

                 vis.append("svg:path")
                    .attr("class","line")
                    .attr("d", d3.svg.line()
                     // d is some magic that iterates over the d3values object
                    .x( function(d) { return x(d.timestamp);} )
                    .y( function(d) { return y(d.d);} ));

                vis.selectAll("circle.line")
                    .data(d3values)
                .enter().append("svg:circle")
                    .attr("class","line")
                    .attr("cx", function(d) { return x(d.timestamp);})
                    .attr("cy", function(d) { return y(d.d);})
                    .attr("r", 2);
            });

    </script>
</body>
</html>

